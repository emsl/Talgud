<div class="container-left">
  <%= render 'submenu' %>
</div>
<div class="container-right">
  <h1><%= t('.title') %></h1>

  <% for event in @events %>
  <li><%= link_to event.name, event_path(event) %></li>
  <% end %>
</div>



<%#
  
<script src="http://maps.google.com/maps/api/js?sensor=false" type="text/javascript"></script>
<script type="text/javascript" charset="utf-8">

  var center = new google.maps.LatLng(58.564, 25.729);
  var map, marker, geocoder;

  function showMap(latitude, longitude) {
      map = new google.maps.Map(document.getElementById('map'), {
          zoom: 7, scrollwheel: false, center: center, mapTypeId: google.maps.MapTypeId.HYBRID
      });
      
      geocoder = new google.maps.Geocoder();
      
      marker = new google.maps.Marker({position: center, map: map, draggable: true});

      google.maps.event.addListener(marker, 'drag', function() {
          $('#event_latitude').val(marker.position.lat());
          $('#event_longitude').val(marker.position.lng());
      });
      
      // Try to determine user location unless it is already known.
      if (latitude && longitude) {
          center.lat = latitude;
          center.lng = longitude;
          centerMap(center);
      } else {
          locateUser();
      }
  }
  
  function locateUser() {
      if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(function(position) {
              centerMap(new google.maps.LatLng(position.coords.latitude, position.coords.longitude), 10);
          }, function() {});
      } else if (google.gears) {
          var geo = google.gears.factory.create('beta.geolocation');
          geo.getCurrentPosition(function(position) {
              centerMap(new google.maps.LatLng(position.latitude, position.longitude), 10);
          }, function() {});
      }
  }
  
  function centerMap(latlng, zoom) {
      if (map && marker) {
          map.setCenter(latlng);
          marker.setPosition(latlng);
          
          if (zoom) {
              map.setZoom(zoom);
          }
      }
  }
  
  function codeAddress(address) {
      if (geocoder) {
          geocoder.geocode({'address': address}, function(results, status) {
              if (status == google.maps.GeocoderStatus.OK) {
                  centerMap(results[0].geometry.location, 10);
              }
          });
      }
  }
  
  showMap($('#event_latitude').val(), $('#event_longitude').val());
</script>

%>